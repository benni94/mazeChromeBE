<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datenbank-Admins</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Dashboard f√ºr Datenbank-Admins</h1>

    <div class="container">
        <div class="card">
            <h2>Name aktualisieren</h2>
            <form id="updateNameForm">
                <div>
                    <label for="findName">Suchen nach Name:</label>
                    <input type="text" id="findName" name="findName" required>
                </div>
                <div>
                    <label for="replaceName">Ersetzen durch:</label>
                    <input type="text" id="replaceName" name="replaceName" required>
                </div>
                <button type="submit">Namen aktualisieren</button>
            </form>
        </div>

        <div class="card">
            <h2>Tabelle leeren</h2>
            <form id="clearTableForm">
                <div>
                    <label for="tableName">Tabellenname: game_progress</label>
                    <input type="text" id="tableName" name="tableName" required>
                </div>
                <button type="submit" class="danger">Tabelle leeren</button>
            </form>
        </div>
    </div>

    <div id="message" style="display: none;"></div>

    <script>
        document.getElementById('updateNameForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const findName = document.getElementById('findName').value;
            const replaceName = document.getElementById('replaceName').value;

            try {
                const response = await fetch('/api/replace-name', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ findName, replaceName }),
                });

                const data = await response.json();
                showMessage(data.success, data.message);
            } catch (error) {
                showMessage(false, 'Fehler: ' + error.message);
            }
        });

        document.getElementById('clearTableForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            if (!confirm('Sind Sie sicher, dass Sie diese Tabelle l schen wollen? Dieser Vorgang kann nicht r ckgesetzt werden!')) {
                return;
            }

            const tableName = document.getElementById('tableName').value;

            try {
                const response = await fetch('/api/clear-table', {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ tableName }),
                });

                const data = await response.json();
                showMessage(data.success, data.message);
            } catch (error) {
                showMessage(false, 'Fehler: ' + error.message);
            }
        });

        function showMessage(isSuccess, message) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = message;
            messageDiv.className = isSuccess ? 'success' : 'error';
            messageDiv.style.display = 'block';

            // Scroll to message
            messageDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>

</html>